(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{8594:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config/runtime_dep",function(){return n(7283)}])},7283:function(s,e,n){"use strict";n.r(e),n.d(e,{__toc:function(){return c},default:function(){return h}});var l=n(2676),r=n(4168),i=n(9733),o={src:"/_next/static/media/fast-url.82b2aa99.png",height:385,width:638,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAQAAADSmGXeAAAAQklEQVR42iXJ0QqAMAxD0f7/f6ovitOJqDS7hq1QQk4iJRovMwuJFPS7XCceICo3h6Gw+YvBXvnYGVM0QRpWTmfqB/teTjDKOKyRAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5},t={src:"/_next/static/media/standby-url.f7e3200a.png",height:489,width:736,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAQAAADSmGXeAAAAO0lEQVR42g3DSQ6AIBAAsPn/Nz15MASXIBimkqYxM000myIzEnxOuwMBHOpS1rg8bs1AV8SbQ1c11pI/CFxOaZw3PaIAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5};let c=[{depth:2,value:"matchFromCaches",id:"matchfromcaches"},{depth:2,value:"writeResponseToCache",id:"writeresponsetocache"},{depth:2,value:"markCacheInvalid",id:"markcacheinvalid"},{depth:2,value:"isValidCache",id:"isvalidcache"},{depth:2,value:"readVersion",id:"readversion"},{depth:2,value:"writeVersion",id:"writeversion"},{depth:2,value:"postMessage",id:"postmessage"},{depth:2,value:"fetchWrapper",id:"fetchwrapper"},{depth:2,value:"isCors",id:"iscors"},{depth:2,value:"getFastestRequests",id:"getfastestrequests"},{depth:2,value:"getStandbyRequests",id:"getstandbyrequests"},{depth:2,value:"fetchFastest",id:"fetchfastest"},{depth:2,value:"fetchStandby",id:"fetchstandby"},{depth:2,value:"fetchFile",id:"fetchfile"},{depth:2,value:"isBlockRequest",id:"isblockrequest"},{depth:2,value:"modifyRequest",id:"modifyrequest"}];function a(s){let e=Object.assign({h1:"h1",p:"p",code:"code",pre:"pre",span:"span",h2:"h2",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",a:"a",ul:"ul",li:"li",img:"img"},(0,i.a)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h1,{children:"运行时函数依赖"}),"\n",(0,l.jsx)(e.p,{children:"  该配置项用于放置所有仅在浏览器 SW 环境下执行的工具函数。"}),"\n",(0,l.jsxs)(e.p,{children:["  对于每一项配置 ",(0,l.jsx)(e.code,{children:"<KEY>: <function>"}),"：",(0,l.jsx)(e.code,{children:"<KEY>"})," 是函数名（推荐使用小写驼峰式命名），",(0,l.jsx)(e.code,{children:"<function>"})," 是函数体。"]}),"\n",(0,l.jsx)(e.p,{children:"  如果函数体中需要使用其它运行时的环境变量、函数依赖等内容，直接调用即可，如果需要避免 IDE 报错/ 警告，可以在配置文件中声明一些不导出的变量，以此假装上下文中存在该函数。 TS 还可以使用 @ts-ignore 忽略相关的错误。"}),"\n",(0,l.jsx)(e.p,{children:"  例："}),"\n",(0,l.jsx)(e.pre,{"data-language":"typescript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"typescript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {defineRuntimeDep} "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'swpp-backends'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 该代码将在 sw. js 中创建一系列函数："})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// const example = () => console. log('hello')"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// function invokeExample() {"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"//     example()"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"defineRuntimeDep"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"({"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"example"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:". log"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'hello'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"invokeExample"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"function"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"() {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"example"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"})"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 如果为了避免 IDE 报错，还可以在文件任意一个位置编写类似的代码："})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// let example: () => void       good"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// let example = any             不推荐，因为丢失了类型，会影响 IDE 的自动补全和静态类型推断"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 或者直接在函数调用的位置使用 @ts-ignore 也可以避免报错，同样不推荐，理由同上"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"example"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"void"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 这行代码用来消除 IDE 警告"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"matchfromcaches",children:"matchFromCaches"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: RequestInfo | URL) => Promise<Response |undefined>"})}),(0,l.jsx)(e.td,{align:"left",children:"尝试匹配一个缓存"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于从缓存库中读取一个缓存，默认使用 ",(0,l.jsx)(e.a,{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Cache",children:"Cache API"}),"。"]}),"\n",(0,l.jsx)(e.h2,{id:"writeresponsetocache",children:"writeResponseToCache"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: RequestInfo | URL, response: Response, date?: boolean) => Promise<void>"})}),(0,l.jsx)(e.td,{align:"left",children:"写入缓存"})]})})]}),"\n",(0,l.jsx)(e.p,{children:"  该项用于向缓存写入或更新一条数据，默认实现如下："}),"\n",(0,l.jsx)(e.pre,{"data-language":"typescript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"typescript","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" request 请求信息"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" response 响应体"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" date 是否存储时间戳"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  */"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInfo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"URL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" date"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"boolean"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (date) {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 如果需要存储时间戳就新建一个 Response 并写入新的 header"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"headers"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Headers"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".headers);"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"headers"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".set"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"STORAGE_TIMESTAMP"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Date"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".toISOString"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"());"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        response "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".body"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            status"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".status"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            headers"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        });"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"cache"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"caches"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".open"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CACHE_NAME"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"cache"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".put"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" response);"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"};"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 用于消除 IDE 报错，值在其它配置项中插入到 SW"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CACHE_NAME"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"string"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"STORAGE_TIMESTAMP"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"string"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"markcacheinvalid",children:"markCacheInvalid"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: RequestInfo | URL) => Promise<void>"})}),(0,l.jsx)(e.td,{align:"left",children:"标记一个缓存为失效缓存"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  swpp 默认使缓存失效的方法是在响应体当中写入一个 ",(0,l.jsx)(e.a,{href:"/config/cross_env#invalid_key",children:"特定的 header"}),"，当尝试使用这个缓存时，检查缓存是否过期，如果过期则尝试从网络拉取最新内容。"]}),"\n",(0,l.jsxs)(e.p,{children:["  如果需要的话您可以通过自定义 ",(0,l.jsx)(e.code,{children:"markCacheInvalid"})," 和 ",(0,l.jsx)(e.code,{children:"isValidCache"}),"，将缓存失效方法改为立即删除。"]}),"\n",(0,l.jsx)(e.h2,{id:"isvalidcache",children:"isValidCache"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(response: Response, rule: number) => boolean"})}),(0,l.jsx)(e.td,{align:"left",children:"判断缓存是否有效"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于判断一个缓存是否还有效，返回 ",(0,l.jsx)(e.code,{children:"true"})," 将直接使用这个缓存，否则将尝试拉取新的值。"]}),"\n",(0,l.jsx)(e.p,{children:"  其中第二个参数是缓存的过期时间，若为负表明该缓存没有过期时间，为正时单位为毫秒，不可能为零。"}),"\n",(0,l.jsx)(e.p,{children:"  如果您想要将缓存失效方法改为立即删除可以使用如下配置："}),"\n",(0,l.jsx)(e.pre,{"data-language":"typescript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"typescript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {defineRuntimeDep} "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'swpp-backends'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"defineRuntimeDep"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"({"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"markCacheInvalid"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInfo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"URL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"caches"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".open"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CACHE_NAME"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".then"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(cache "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"cache"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".delete"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request))"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isValidCache"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"})"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"let"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CACHE_NAME"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"string"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"readversion",children:"readVersion"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"() => Promise<BrowserVersion | undefined>"})}),(0,l.jsx)(e.td,{align:"left",children:"读取客户端版本号"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于读取客户端当前的版本号，默认实现使用 ",(0,l.jsx)(e.a,{href:"#matchfromcaches",children:"matchFromCaches"})," 读取。"]}),"\n",(0,l.jsx)(e.h2,{id:"writeversion",children:"writeVersion"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(version: BrowserVersion) => Promise<void>"})}),(0,l.jsx)(e.td,{align:"left",children:"更新客户端版本号"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于设置客户端当前的版本号，默认实现使用 ",(0,l.jsx)(e.a,{href:"#writeresponsetocache",children:"writeResponseToCache"})," 实现。"]}),"\n",(0,l.jsxs)(e.p,{children:["  注意：如果您需要自定义该项目，务必在写入缓存前，为传入的 ",(0,l.jsx)(e.code,{children:"version"})," 中的 ",(0,l.jsx)(e.code,{children:"tp"})," 字段赋值：",(0,l.jsx)(e.code,{children:"version.tp = Date.now()"}),"。"]}),"\n",(0,l.jsx)(e.h2,{id:"postmessage",children:"postMessage"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(type: string, data: any, ...goals: Client[]) => Promise<void>"})}),(0,l.jsx)(e.td,{align:"left",children:"向指定客户端发送消息"})]})})]}),"\n",(0,l.jsx)(e.p,{children:"  该配置项用于向指定的客户端发送消息，其中各个变量解释如下："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"type"}),": 消息类型"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"data"}),": 消息内容"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"goals"}),": 客户端对象，若该项传入了一个空的数组，表明向所有客户端发送消息"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"fetchwrapper",children:"fetchWrapper"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request, banCache: boolean, cors: boolean, optional?: RequestInit) => Promise<Response>"})}),(0,l.jsx)(e.td,{align:"left",children:"从网络拉取文件"})]})})]}),"\n",(0,l.jsx)(e.p,{children:"  一般不需要覆盖，默认实现如下："}),"\n",(0,l.jsx)(e.pre,{"data-language":"typescript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"typescript","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"/**"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" request 请求信息"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" banCache 是否禁用 HTTP 缓存"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" cors 是否启用 cors，填 false 使用 no-cors 模式"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  * "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"@param"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:" optional 请求配置"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"  */"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" banCache"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"boolean"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" cors"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"boolean"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" optional"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInit"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Promise"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"> "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"init"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInit"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        referrerPolicy"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".referrerPolicy "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"??"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"optional"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"init"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".cache "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" banCache "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'no-store'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'default'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (cors) {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"init"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".mode "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'cors'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"init"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".credentials "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'same-origin'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"fetch"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" init)"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"iscors",children:"isCors"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request) => boolean"})}),(0,l.jsx)(e.td,{align:"left",children:"判断一个资源是否使用 cors"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于判断一个资源是使用 cors 还是 no-cors 模式，返回 ",(0,l.jsx)(e.code,{children:"true"})," 表示使用 cors 模式，否则表示使用 no-cors。默认永远返回 ",(0,l.jsx)(e.code,{children:"false"}),"。"]}),"\n",(0,l.jsx)(e.p,{children:"  由于 no-cors 模式下 swpp 无法读取响应体中的状态码，所以对于需要应用缓存、URL 竞速、备用 URL 的请求，全部强制使用 cors 模式。"}),"\n",(0,l.jsx)(e.h2,{id:"getfastestrequests",children:"getFastestRequests"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request) => Request[] | undefined"})}),(0,l.jsx)(e.td,{align:"left",children:"获取竞速列表"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于启用 URL 竞速，返回任意转换为 ",(0,l.jsx)(e.code,{children:"false"})," 的值均表示对于给定的资源不启用 URL 竞速。"]}),"\n",(0,l.jsx)(e.p,{children:"  注意事项："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["swpp 会严格按照返回的数组中的内容进行并发请求，如果您返回的数组中不包含原有的 ",(0,l.jsx)(e.code,{children:"Request"}),"，swpp 将认为您希望跳过原有的资源地址。"]}),"\n",(0,l.jsx)(e.li,{children:"开启该功能后，会较为显著地增加网络压力、流量消耗和 CPU 压力。"}),"\n",(0,l.jsx)(e.li,{children:"请勿滥用该功能（包括但不限于使用该功能实现类似于将网站部署到 NPM CDN 上的功能），这有违道德、容易被 CDN 封杀。"}),"\n",(0,l.jsxs)(e.li,{children:["自定义前请阅读：",(0,l.jsx)(e.a,{href:"#isfetchsuccessful",children:"/config/cross_dep#isFetchSuccessful"})]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"getstandbyrequests",children:"getStandbyRequests"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request) => {t: number, r: Request | undefined, l: () => Request[]} | undefined"})}),(0,l.jsx)(e.td,{align:"left",children:"获取备用列表"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项用于启用备用 URL，返回任意转换为 ",(0,l.jsx)(e.code,{children:"false"})," 值均表示对于给定的资源不启用备用 URL。"]}),"\n",(0,l.jsx)(e.p,{children:"  对于返回值："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"t"}),": 超时时间（毫秒），如果拉取原始 ",(0,l.jsx)(e.code,{children:"Request"})," 的时间超过了这个时间，将会开始并发拉取备用 URL。"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"l"}),": 备用 Request 列表的 getter，设计成这样是避免在无需备用 URL 时生成列表占用 CPU、内存资源。"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"r"}),": 替换原始 URL，不设置为 ",(0,l.jsx)(e.code,{children:"undefined"})," 表示不进行替换"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"  注意事项："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["返回的 ",(0,l.jsx)(e.code,{children:"l"})," 列表中不应当包含原始 ",(0,l.jsx)(e.code,{children:"Request"}),"，swpp 会先尝试访问原始 ",(0,l.jsx)(e.code,{children:"Request"}),"。"]}),"\n",(0,l.jsxs)(e.li,{children:["应当把最可能成功、速度最快的链接设置为原始 ",(0,l.jsx)(e.code,{children:"Request"}),"，否则网站加载可能会出现比较大的延迟。"]}),"\n",(0,l.jsxs)(e.li,{children:["自定义前请阅读：",(0,l.jsx)(e.a,{href:"#isfetchsuccessful",children:"/config/cross_dep#isFetchSuccessful"})]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"fetchfastest",children:"fetchFastest"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(list: Request[], optional?: RequestInit) => Promise<Response>"})}),(0,l.jsx)(e.td,{align:"left",children:"通过竞速拉取文件"})]})})]}),"\n",(0,l.jsx)(e.p,{children:"  该项用于执行 URL 竞速的功能，默认实现已经能满足大部分需求，一般情况下无需覆盖。"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{alt:"URL 竞速流程",placeholder:"blur",src:o})}),"\n",(0,l.jsx)(e.h2,{id:"fetchstandby",children:"fetchStandby"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request, standbyRequests: {t: number, r: Request | undefined, l: () => Request[]}, optional?: RequestInit) => Promise<Response>"})}),(0,l.jsx)(e.td,{align:"left",children:"通过备用 URL 拉取文件"})]})})]}),"\n",(0,l.jsx)(e.p,{children:"  该项用于执行备用 URL 功能，默认实现已经能满足大部分需求，一般情况下无需覆盖。"}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{alt:"备用 URL 流程",placeholder:"blur",src:t})}),"\n",(0,l.jsx)(e.h2,{id:"fetchfile",children:"fetchFile"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: RequestInfo | URL, optional?: RequestInit) => Promise<Response>"})}),(0,l.jsx)(e.td,{align:"left",children:"从网络拉取文件"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  该项是对 URL 竞速和备用 URL 的封装，如果您启用了这两个功能中的至少一个，swpp 将自动为您生成合适的 ",(0,l.jsx)(e.code,{children:"fetchFile"})," 函数。"]}),"\n",(0,l.jsx)(e.p,{children:"  一般情况下无需修改该项，您的修改会完全覆盖 swpp 原有的逻辑。若您修改了该项但没有手动调用 URL 竞速和备用 URL 的接口，即使设置了相关的属性功能也无法生效。"}),"\n",(0,l.jsx)(e.p,{children:"  默认实现如下："}),"\n",(0,l.jsx)(e.pre,{"data-language":"typescript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"typescript","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// noinspection TypeScriptUnresolvedReference"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {defineLazyInitConfig} "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'swpp-backends'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 在这段代码中 fetchFastestAndStandbyRequests、fetchFastestRequests 和 fetchStandbyRequests 三者"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 都是在 swpp 内部定义的三个函数，感兴趣的可以翻看 RuntimeDepCode.ts 源码"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"defineLazyInitConfig"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"((runtime) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"runtimeDep"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"runtime"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".runtimeDep"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"hasFastestRequests"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"runtimeDep"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".hasValue"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'getFastestRequests'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"hasStandbyRequests"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"runtimeDep"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".hasValue"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'getStandbyRequests'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (hasFastestRequests "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" hasStandbyRequests) {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fetchFastestAndStandbyRequests"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    } "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (hasFastestRequests) {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fetchFastestRequests"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    } "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (hasStandbyRequests) {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fetchStandbyRequests"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    } "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInfo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"URL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" optional"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"RequestInit"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Promise"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Response"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"> "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// @ts-ignore"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".url) request "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"new"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request)"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"fetchWrapper"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(request"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"true"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"true"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" optional)"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"})"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"isblockrequest",children:"isBlockRequest"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request) => boolean"})}),(0,l.jsx)(e.td,{align:"left",children:"判断是否应当阻断请求"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  如果网站中存在需要屏蔽的请求，那么可以使用该功能阻断这些请求。若函数返回了 ",(0,l.jsx)(e.code,{children:"true"}),"，那么 swpp 将不再通过网络拉取文件，而是直接向上级返回 ",(0,l.jsx)(e.code,{children:"204"})," 状态码的响应体。"]}),"\n",(0,l.jsx)(e.p,{children:"  注意：swpp 只能阻断网络请求，而无法阻止上游处理该请求的结果。"}),"\n",(0,l.jsx)(e.h2,{id:"modifyrequest",children:"modifyRequest"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{align:"center",children:"类型"}),(0,l.jsx)(e.th,{align:"left",children:"说明"})]})}),(0,l.jsx)(e.tbody,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{align:"center",children:(0,l.jsx)(e.code,{children:"(request: Request) => Request | null | undefined"})}),(0,l.jsx)(e.td,{align:"left",children:"修改请求"})]})})]}),"\n",(0,l.jsxs)(e.p,{children:["  如果您想要修改请求的内容，可以使用该功能返回一个新的 ",(0,l.jsx)(e.code,{children:"Request"})," 以代替原始的 ",(0,l.jsx)(e.code,{children:"Request"}),"。"]}),"\n",(0,l.jsxs)(e.p,{children:["  您可以修改 ",(0,l.jsx)(e.code,{children:"Request"})," 中的任何内容，但是由于浏览器限制，您无法修改 ",(0,l.jsx)(e.code,{children:"referer"})," 和 ",(0,l.jsx)(e.code,{children:"user-agent"}),"。"]}),"\n",(0,l.jsxs)(e.p,{children:["  函数返回 ",(0,l.jsx)(e.code,{children:"Request"})," 表示对当前资源启用该功能，返回任意转换为 ",(0,l.jsx)(e.code,{children:"false"})," 的值表示禁用。"]})]})}var h=(0,r.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.a)(),s.components);return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(a,{...s})}):a(s)},pageOpts:{filePath:"pages/config/runtime_dep.mdx",route:"/config/runtime_dep",timestamp:1742657031e3,title:"运行时函数依赖",headings:c},pageNextRoute:"/config/runtime_dep"})}},function(s){s.O(0,[168,888,774,179],function(){return s(s.s=8594)}),_N_E=s.O()}]);